<view class="container">
  <!-- 顶部提示 -->
  <view class="tip-bar">
    <text class="tip-text">{{tipText}}</text>
  </view>

  <!-- 画布区域 -->
  <view class="canvas-wrapper">
    <view class="canvas-bg">
      <!-- 参考线网格 -->
      <view class="grid-overlay" wx:if="{{showGrid}}"></view>
      <canvas 
        type="2d" 
        id="drawCanvas" 
        class="draw-canvas"
        bindtouchstart="onTouchStart"
        bindtouchmove="onTouchMove"
        bindtouchend="onTouchEnd"
      ></canvas>
    </view>
    <!-- 鱼朝向提示 -->
    <view class="direction-hint">
      <text>← 请画鱼头朝左的鱼</text>
    </view>
  </view>

  <!-- 颜色选择器 -->
  <view class="color-picker">
    <view 
      class="color-item {{currentColor === item ? 'active' : ''}}"
      wx:for="{{colors}}"
      wx:key="*this"
      style="background:{{item}};"
      bindtap="selectColor"
      data-color="{{item}}"
    >
      <view class="color-check" wx:if="{{currentColor === item}}">✓</view>
    </view>
  </view>

  <!-- 工具栏 -->
  <view class="toolbar">
    <view class="tool-group">
      <!-- 画笔大小 -->
      <view class="tool-section">
        <text class="tool-label">画笔</text>
        <view class="size-options">
          <view 
            class="size-dot {{brushSize === item.size ? 'active' : ''}}" 
            wx:for="{{brushSizes}}" wx:key="size"
            bindtap="selectSize" data-size="{{item.size}}"
          >
            <view class="dot-inner" style="width:{{item.display}}rpx;height:{{item.display}}rpx;"></view>
          </view>
        </view>
      </view>

      <!-- 工具按钮 -->
      <view class="tool-section">
        <text class="tool-label">工具</text>
        <view class="tool-buttons">
          <view class="tool-btn {{isEraser ? 'active' : ''}}" bindtap="toggleEraser">
            <text>橡皮</text>
          </view>
          <view class="tool-btn" bindtap="undoStroke">
            <text>撤销</text>
          </view>
          <view class="tool-btn danger" bindtap="clearCanvas">
            <text>清空</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 提交按钮 -->
  <view class="submit-bar">
    <view class="btn-my-fish" bindtap="goToTank">
      <text>我的鱼</text>
    </view>
    <view class="btn-submit {{canSubmit ? '' : 'disabled'}}" bindtap="submitFish">
      <text>🐟 让它游起来！</text>
    </view>
  </view>

  <!-- 评分弹窗 -->
  <view class="score-overlay" wx:if="{{showScore}}" bindtap="closeScore">
    <view class="score-card" catchtap="">
      <view class="fish-preview-wrap">
        <image wx:if="{{fishPreview}}" class="fish-preview" src="{{fishPreview}}" mode="aspectFit" />
      </view>
      <view class="fish-no" wx:if="{{fishNo > 0}}">NO.{{fishNo}}</view>
      <view class="score-value" style="color:{{scoreColor}}">{{score}}分</view>
      <view class="score-comment">{{scoreComment}}</view>
      <input class="fish-name-input" placeholder="给你的鱼取个名字" maxlength="8" value="{{fishName}}" bindinput="onNameInput" />
      <input class="fish-name-input" placeholder="创作者名称（选填）" maxlength="10" value="{{authorName}}" bindinput="onAuthorInput" />
      <view class="score-actions">
        <view class="btn-action primary" bindtap="confirmFish">
          <text>放入鱼缸 🎉</text>
        </view>
        <view class="btn-action" bindtap="redraw">
          <text>重新画</text>
        </view>
      </view>
    </view>
  </view>
</view>
