<view class="container {{isDark ? '' : 'theme-light'}}">
  <!-- æ°´é¢å…‰æ•ˆ -->
  <view class="water-surface">
    <view class="light-ray" wx:for="{{5}}" wx:key="*this" style="left:{{item * 20 + 5}}%; animation-delay:{{item * 0.6}}s;"></view>
  </view>

  <!-- é±¼ç¼¸ Canvas -->
  <canvas type="2d" id="tankCanvas" class="tank-canvas" bindtouchstart="onTankTap"></canvas>

  <!-- æ°”æ³¡è£…é¥° -->
  <view class="bubble-container">
    <view class="bubble" wx:for="{{bubbles}}" wx:key="id"
      style="left:{{item.x}}%; width:{{item.size}}rpx; height:{{item.size}}rpx; animation-duration:{{item.duration}}s; animation-delay:{{item.delay}}s;">
    </view>
  </view>

  <!-- åº•éƒ¨æ²™åœ° -->
  <!-- <view class="sand-bottom">
    <view class="seaweed-group" wx:for="{{seaweeds}}" wx:key="id"
      style="left:{{item.x}}%;">
      <view class="seaweed-leaf {{item.type}}"
        style="height:{{item.h}}rpx; animation-delay:{{item.delay}}s; animation-duration:{{item.dur}}s;">
      </view>
      <view class="seaweed-leaf {{item.type}}" wx:if="{{item.h > 80}}"
        style="height:{{item.h * 0.7}}rpx; animation-delay:{{item.delay + 0.3}}s; animation-duration:{{item.dur + 0.5}}s; transform: translateX(-8rpx) rotate(-5deg);">
      </view>
    </view>
  </view> -->

  <!-- æ”¾ç”ŸåŠ¨ç”» -->
  <block wx:if="{{releaseMode}}">
    <view class="release-fish">
      <image wx:if="{{releasePreview}}" src="{{releasePreview}}" mode="aspectFit" class="release-fish-img" />
    </view>
    <view class="release-ripple release-ripple-1"></view>
    <view class="release-ripple release-ripple-2"></view>
    <view class="release-ripple release-ripple-3"></view>
    <view class="release-bubble release-bubble-1"></view>
    <view class="release-bubble release-bubble-2"></view>
    <view class="release-bubble release-bubble-3"></view>
    <view class="release-bubble release-bubble-4"></view>
    <view class="release-bubble release-bubble-5"></view>
    <view class="release-bubble release-bubble-6"></view>
    <view class="release-text">{{releaseText}}</view>
  </block>

  <!-- é¡¶éƒ¨æ  -->
  <view class="top-bar" style="top:{{statusBarHeight + 8}}px;">
    <view class="fish-count" catchtap="onCountTap">
      <text class="count-text">ğŸŒŠ {{fishCount}} æ¡é±¼åœ¨æ¸¸æ³³</text>
    </view>
    <view class="btn-theme" catchtap="toggleTheme">
      <text>{{isDark ? 'â˜€ï¸' : 'ğŸŒ™'}}</text>
    </view>
    <button class="btn-share" open-type="share">
      <text>ğŸ“¤</text>
    </button>
  </view>

  <!-- é±¼ä¿¡æ¯å¼¹çª— -->
  <view class="fish-info-overlay" wx:if="{{showFishInfo}}" bindtap="closeFishInfo">
    <view class="fish-info-card" catchtap="">
      <view class="fish-info-close" bindtap="closeFishInfo">âœ•</view>
      <image wx:if="{{selectedFish.imageUrl}}" class="fish-info-image" src="{{selectedFish.imageUrl}}" mode="aspectFit" />
      <view class="fish-info-no" wx:if="{{selectedFish.fishNo > 0}}">NO.{{selectedFish.fishNo}}</view>
      <view class="fish-info-name">{{selectedFish.name}}</view>
      <view class="fish-info-author" wx:if="{{selectedFish.author}}">by {{selectedFish.author}}</view>
      <view class="fish-info-score">{{selectedFish.score}} åˆ†</view>
      <view class="fish-info-time">{{selectedFish.timeText}} åŠ å…¥é±¼ç¼¸</view>
      <view class="fish-info-pet-count">è¢«æ‘¸äº† {{selectedFish.petCount}} æ¬¡</view>
      <view class="fish-info-btn {{hasPettedSelected ? 'disabled' : ''}}" bindtap="petSelectedFish">
        {{hasPettedSelected ? 'å·²æ‘¸è¿‡ âœ“' : 'æ‘¸ä¸€ä¸‹ ğŸŸ'}}
      </view>
    </view>
  </view>

  <!-- åˆ†äº«å¡ç‰‡å¼¹çª— -->
  <view class="share-overlay" wx:if="{{showShareCard}}" bindtap="closeShareCard">
    <view class="share-card" catchtap="noop">
      <view class="share-card-inner">
        <!-- è£…é¥°æ³¢æµª -->
        <view class="share-wave share-wave-1"></view>
        <view class="share-wave share-wave-2"></view>
        <!-- åˆ‡æ¢æ–‡æ¡ˆæŒ‰é’® -->
        <view class="share-switch-btn" catchtap="switchQuote">æ¢ä¸€å¥</view>
        <!-- é±¼å›¾ -->
        <view class="share-fish-wrap">
          <image wx:if="{{shareFishPreview}}" class="share-fish-img" src="{{shareFishPreview}}" mode="aspectFit" />
        </view>
        <view class="share-fish-name">{{shareFishName}}</view>
        <!-- æ–‡æ¡ˆ -->
        <view class="share-quote">{{shareQuote}}</view>
        <view class="share-subtitle" wx:if="{{shareFishNo > 0}}">No.{{shareFishNo}} å·²è¿›å…¥æ± å¡˜</view>
        <!-- äºŒç»´ç  -->
        <view class="share-qr-wrap">
          <image class="share-qrcode" src="/images/qcord.png" mode="aspectFit" />
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="btn-draw" bindtap="goToDraw">
      <view class="btn-icon btn-icon-flip">âœï¸</view>
      <text class="btn-text">ç”»ä¸€æ¡é±¼</text>
    </view>
    <view class="btn-gallery" bindtap="goToTank">
      <view class="btn-icon">ğŸ†</view>
      <text class="btn-text">æ’è¡Œæ¦œ</text>
    </view>
  </view>
</view>
